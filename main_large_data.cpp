#include <iostream>
#include "maxent.h"
#include <vector>
#include <stdlib.h>
using namespace std; 
#include <selforg/matrix.h>


void testMaxent(){
  
  //Main hyperparameters:
  int grid_size = 5;
  int n_trajectories = 20;
  int trajectory_length  = 15;
  int epochs = 2000;


  double discount = 0.01;
  double learning_rate = 0.01;
  int n_actions = 4;
  int n_states = (int) (grid_size* grid_size);

  //Main useful parameters
  int nn = n_states; 
  int dd = nn;    //dd ==nn?? or 4? 
  int aa = n_actions; 
  int tt = n_trajectories;
  int ll = trajectory_length; 


  matrix::Matrix feature_matrix;  //(number of states, dimensionality of states== default is 4??)
  feature_matrix.set(nn,dd);
  feature_matrix.toId();
  //std::cout  << feature_matrix.getM() <<feature_matrix.getN()  <<std::endl;

  matrix::Matrix ground_r;
  ground_r.set(nn,1);
  ground_r.val(nn-1,0) = 1;

  // TODO change the following from here:
  // (tt,ll,2) => (2* tt, ll) =>(2,tt*ll)
  double data[2*tt*ll] = {0,  1,  6,  7,  8, 13, 12, 13, 14, 19, 19, 24, 24, 24, 24,
                          0,  1,  2,  7, 12, 13, 12,  7,  8,  9,  4,  9,  9, 14, 19,
                          0,  1,  6, 11, 12, 13, 12, 17, 18, 19, 14, 19, 24, 24, 24,
                          0,  5, 10,  5, 10, 15, 20, 20, 20, 20, 20, 15, 16, 17, 22,
                          0,  0,  1,  2,  3,  8,  9, 14, 14, 14, 14,  9,  4,  9, 14,
                          0,  5, 10, 11, 12, 17, 18, 23, 23, 24, 24, 24, 24, 23, 23,
                          0,  1,  6, 11,  6,  7, 12,  7,  2,  3,  4,  9, 14, 19, 19,
                          0,  1,  2,  7, 12, 13, 18, 23, 23, 22, 22, 22, 23, 24, 24,
                          0,  1,  0,  5,  6, 11, 12, 17, 18, 19, 14, 19, 19, 19, 18,
                          0,  0,  1,  6,  7,  8, 13, 14, 19, 24, 24, 24, 24, 24, 23,
                          0,  0,  1,  6, 11, 12, 17, 18, 23, 23, 23, 22, 23, 23, 24,
                          0,  5,  6, 11, 12, 13, 14, 19, 24, 24, 24, 24, 24, 24, 24,
                          0,  1,  6,  5,  5,  6,  7,  8,  9,  4,  4,  9, 14, 19, 24,
                          0,  5,  5,  0,  1,  6,  1,  6, 11, 12, 13, 14, 14,  9, 14,
                          0,  5, 10, 11, 16, 21, 21, 21, 22, 23, 23, 23, 23, 24, 24,
                          0,  5,  6, 11, 12, 13, 12, 13, 18, 19, 19, 24, 23, 24, 24,
                          0,  5, 10, 15, 16, 21, 16, 17, 16, 11, 12, 17, 22, 22, 23,
                          0,  0,  1,  2,  7,  6,  7,  6,  7,  2,  1,  6,  7, 12, 13,
                          0,  1,  6,  7, 12, 13, 14, 14, 13, 18, 19, 24, 24, 24, 24,
                          0,  5,  6, 11, 12, 13,  8, 13, 18, 19, 24, 19, 19, 19, 24,  //state_sequence

                          0, 1, 0, 0, 1, 2, 0, 0, 1, 0, 1, 0, 1, 1, 0,
                          0, 0, 1, 1, 0, 2, 3, 0, 0, 3, 1, 0, 1, 1, 1,
                          0, 1, 1, 0, 0, 2, 1, 0, 0, 3, 1, 1, 1, 0, 2,
                          1, 1, 3, 1, 1, 1, 1, 1, 2, 1, 3, 0, 0, 1, 0,
                          3, 0, 0, 0, 1, 0, 1, 0, 0, 0, 3, 3, 1, 1, 1,
                          1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 2, 1, 2,
                          0, 1, 1, 3, 0, 1, 3, 3, 0, 0, 1, 1, 1, 0, 0,
                          0, 0, 1, 1, 0, 1, 1, 1, 2, 1, 1, 0, 0, 1, 1,
                          0, 2, 1, 0, 1, 0, 1, 0, 0, 3, 1, 0, 0, 2, 0,
                          2, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 2, 1,
                          3, 0, 1, 1, 0, 1, 0, 1, 1, 1, 2, 0, 1, 0, 0,
                          1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1,
                          0, 1, 2, 2, 0, 0, 0, 0, 3, 0, 1, 1, 1, 1, 1,
                          1, 2, 3, 0, 1, 3, 1, 1, 0, 0, 0, 0, 3, 1, 0,
                          1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 2,
                          1, 0, 1, 0, 0, 2, 0, 1, 0, 0, 1, 2, 0, 0, 0,
                          1, 1, 1, 0, 1, 3, 0, 2, 3, 0, 1, 1, 1, 0, 1,
                          3, 0, 0, 1, 2, 0, 2, 0, 3, 2, 1, 0, 1, 0, 3,
                          0, 1, 0, 1, 0, 0, 0, 2, 1, 0, 1, 0, 0, 0, 0,
                          1, 0, 1, 0, 0, 3, 1, 1, 0, 1, 3, 0, 0, 1, 1};   //action_sequence





  //(2*T , L) => (0:2 , T*L) then (1, T*L) -> (T, L) based on specific state,
  //                              (2, T*L) -> (T, L) based on specific action.
  //if add another dimension reward then ((3, T*L) -> (T, L) based on corresponding reward)
  matrix::Matrix trajectories;
  trajectories.set(2*tt, ll, data);

  
  //transition_probability is fixed for both before training and after training!
  //trans_prob for every row should add up to 1 meaning (state, action) -> next_state
  double trans[nn*aa*nn] = {0.150,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.075,0.075,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.075,0.075,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.075,0.075,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.075,0.850,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.075,0.000,0.000,0.000,0.000,0.075,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.775,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.075,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.775,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.075,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.775,0.000,0.000,0.000,0.075,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.775,0.000,0.000,0.000,0.000,0.075,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.150,0.775,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.075,0.775,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.075,0.775,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.075,0.775,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.850,
                            0.150,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.075,0.075,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.075,0.075,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.075,0.075,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.075,0.150,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.075,0.000,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.775,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.000,0.775,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.850,0.075,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.775,0.075,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.775,0.075,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.775,0.075,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.075,0.850,
                            0.850,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.775,0.075,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.775,0.075,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.775,0.075,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.775,0.150,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.075,0.000,0.000,0.000,0.000,0.775,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.075,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.775,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.075,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.775,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.000,0.075,0.000,0.000,0.000,0.075,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.075,0.000,0.000,0.000,0.000,0.075,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.850,0.075,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.075,0.075,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.075,0.075,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.075,0.075,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.775,0.150,
                            0.850,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.075,0.775,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.075,0.775,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.075,0.775,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.075,0.850,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.775,0.000,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.000,0.075,0.000,0.000,0.000,0.075,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.075,0.000,0.000,0.000,0.000,0.075,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.000,0.150,0.075,0.000,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.075,0.075,0.000,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.075,0.075,0.000,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.075,0.075,
                            0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.775,0.000,0.000,0.000,0.075,0.150};

  // 25states , 5 actions







  //(A*N , N) => (A , N*N) then (a, N*N) -> (N, N) based on specific a (action) 
  matrix::Matrix transition_probabilities;  //(state, action, state) (N, A, N) => (A*N , N) => (A , N*N)
  transition_probabilities.set(n_states*n_actions, n_states, trans);
  
  Maxent* maxent = new Maxent();
  maxent->init(nn, dd, aa, tt, ll);

  matrix::Matrix reward;
  reward.set(n_states, 1);
  reward = maxent->irl(feature_matrix, n_actions, discount, transition_probabilities, trajectories, epochs, learning_rate);
  
  std::cout<< "irl reward is: " << std::endl<< reward<< std::endl;
  std::cout<< "ground truth reward is: " << std::endl<< ground_r << std::endl;


}



int main(){
  srand(time(0));
  
  cout << "******************** TEST Maxent ********************\n";
  testMaxent();
 
  return 0;
}




// test expected result: (from python)

